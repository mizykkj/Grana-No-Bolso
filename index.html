<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Central de Jogos - Jogue Agora!</title>
    <link rel="stylesheet" href="style.css">
    <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-9402908836616610"
         crossorigin="anonymous"></script>
</head>
<body>
    <div class="container">
        <div class="top-page-actions">
            <div id="loggedInUserInfo" style="display: none;"> <span id="loggedInUserEmail" class="user-email-display"></span>
                <a href="#" id="logoutModalButton" class="top-nav-link logout-link">Sair</a>
            </div>
            <a href="#" id="loginTriggerLink" class="top-nav-link">Login</a> <button id="aboutButton" class="about-button">Sobre</button>
        </div>

        <header>
            <h1>Bem-vindo à Central de Jogos!</h1>
            <p>Escolha um dos nossos jogos clássicos para se divertir.</p>
        </header>

        <nav class="game-selection">
            <h2>Escolha seu Jogo:</h2>
            <ul>
                <li><a href="snake.html" class="game-link">Jogo da Cobrinha</a></li>
                <li><a href="pong.html" class="game-link">Pong Clássico</a></li>
                <li><a href="quebra_blocos.html" class="game-link">Quebra Blocos</a></li>
            </ul>
        </nav>

        <section class="adsense-area">
            <h2>Anúncios</h2>
            <p>Espaço reservado para anúncios do Google AdSense. <br> Configure sua conta AdSense e cole o código aqui para monetizar seu site.</p>
        </section>

        <footer>
            <p>&copy; 2025 Central de Jogos - Todos os direitos reservados.</p>
        </footer>
    </div> <div id="aboutModal" class="modal">
        <div class="modal-content">
            <span class="close-button about-modal-close">&times;</span> <h2>Sobre a Central de Jogos</h2>
            <p>Bem-vindo à Central de Jogos! Este espaço foi cuidadosamente desenvolvido por <strong><a href="https://www.instagram.com/mizykj/" target="_blank" rel="noopener noreferrer" class="inline-link">Mizy Dev</a></strong>.</p>
            <p>A principal motivação por trás da criação deste site é simples: trazer diversão e um toque de nostalgia através de jogos clássicos que marcaram gerações. Queremos oferecer um local onde você possa relaxar, desafiar a si mesmo e, quem sabe, relembrar bons momentos.</p>
            <p>Cada jogo foi implementado com o intuito de ser leve, acessível e fácil de jogar. Esperamos que você desfrute da experiência tanto quanto nós gostamos de criá-la.</p>
            <p>Divirta-se!</p>
            <p><em>- <a href="https://www.instagram.com/mizykj/" target="_blank" rel="noopener noreferrer" class="inline-link">Mizy Dev</a></em></p>
        </div>
    </div>

    <div id="authModal" class="modal"> <div class="modal-content auth-modal-content"> <span class="close-button auth-modal-close">&times;</span> <div class="auth-form" id="loginContainerModal">
                <h3>Acesse sua Conta</h3>
                <form id="formLoginModal">
                    <div>
                        <label for="loginEmailModal">Email:</label>
                        <input type="email" id="loginEmailModal" name="loginEmailModal" required>
                    </div>
                    <div>
                        <label for="loginSenhaModal">Senha:</label>
                        <input type="password" id="loginSenhaModal" name="loginSenhaModal" required>
                    </div>
                    <button type="submit">Entrar</button>
                </form>
                <p class="toggle-form-link">Não possui uma conta? <a href="#" id="switchToRegisterInModalLink">Crie uma</a></p>
            </div>

            <div class="auth-form" id="registroContainerModal" style="display: none;">
                <h3>Crie sua Conta</h3>
                <form id="formRegistroModal">
                    <div>
                        <label for="registroEmailModal">Email:</label>
                        <input type="email" id="registroEmailModal" name="registroEmailModal" required>
                    </div>
                    <div>
                        <label for="registroSenhaModal">Senha (mínimo 6 caracteres):</label>
                        <input type="password" id="registroSenhaModal" name="registroSenhaModal" required minlength="6">
                    </div>
                    <div>
                        <label for="registroConfirmaSenhaModal">Confirmar Senha:</label>
                        <input type="password" id="registroConfirmaSenhaModal" name="registroConfirmaSenhaModal" required minlength="6">
                    </div>
                    <button type="submit">Registrar</button>
                </form>
                <p class="toggle-form-link">Já possui uma conta? <a href="#" id="switchToLoginInModalLink">Faça login</a></p>
            </div>

            <p id="authMessageModal" class="auth-message"></p>
        </div>
    </div>


    <script>
        const aboutModal = document.getElementById('aboutModal');
        const aboutBtn = document.getElementById('aboutButton');
        const aboutModalCloseBtn = aboutModal.querySelector('.about-modal-close'); // Usar a classe específica

        if (aboutBtn) {
            aboutBtn.onclick = function() {
                aboutModal.style.display = 'flex'; // Usar 'flex' para centralizar (conforme CSS do modal)
                setTimeout(function() {
                    aboutModal.classList.add('modal-visible');
                }, 10);
                document.body.classList.add('modal-open');
            }
        }

        function closeAboutModal() {
            aboutModal.classList.remove('modal-visible');
            document.body.classList.remove('modal-open');
            setTimeout(function() {
                if (!aboutModal.classList.contains('modal-visible')) {
                    aboutModal.style.display = 'none';
                }
            }, 300); // Duração da transição
        }

        if (aboutModalCloseBtn) aboutModalCloseBtn.onclick = closeAboutModal;
        
        window.addEventListener('click', function(event) { // Mudado para addEventListener
            if (event.target == aboutModal) {
                closeAboutModal();
            }
        });
    </script>

    <script src="https://www.gstatic.com/firebasejs/9.6.10/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.6.10/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.6.10/firebase-firestore-compat.js"></script>
    <script>
      const firebaseConfig = {
        apiKey: "AIzaSyBYLGHFCAe_Go88NLg9huffQcaH65O8AxU", // SUBSTITUA PELO SEU VALOR REAL
        authDomain: "central-de-jogos-4bdf1.firebaseapp.com", // SUBSTITUA PELO SEU VALOR REAL
        projectId: "central-de-jogos-4bdf1", // SUBSTITUA PELO SEU VALOR REAL
        storageBucket: "central-de-jogos-4bdf1.appspot.com", // VERIFIQUE ESTE VALOR
        messagingSenderId: "552827412845", // SUBSTITUA PELO SEU VALOR REAL
        appId: "1:552827412845:web:57af946ce0b1a53a113a64", // SUBSTITUA PELO SEU VALOR REAL
        measurementId: "G-RDL4Y8ELKQ" // SUBSTITUA PELO SEU VALOR REAL (opcional)
      };
      firebase.initializeApp(firebaseConfig);
      const auth = firebase.auth();
      const db = firebase.firestore();
      window.firebaseAuth = auth;
      window.firebaseDb = db;
      console.log("Firebase Compat SDKs carregados e Firebase inicializado!");
    </script>

    <script>
        // Elementos da Nova UI de Login/Logout no Topo
        const loginTriggerLink = document.getElementById('loginTriggerLink');
        const loggedInUserInfo = document.getElementById('loggedInUserInfo');
        const loggedInUserEmailDisplay = document.getElementById('loggedInUserEmail');
        const logoutModalButton = document.getElementById('logoutModalButton'); // Renomeado para evitar conflito

        // Elementos do Modal de Autenticação
        const authModal = document.getElementById('authModal');
        const authModalCloseBtn = authModal.querySelector('.auth-modal-close'); // Usar a classe específica

        // Containers dos formulários dentro do Modal
        const loginContainerModal = document.getElementById('loginContainerModal');
        const registroContainerModal = document.getElementById('registroContainerModal');

        // Formulários e Inputs (adicionar 'Modal' aos IDs para evitar conflitos se os antigos ainda existirem)
        const formLoginModal = document.getElementById('formLoginModal');
        const loginEmailModalInput = document.getElementById('loginEmailModal');
        const loginSenhaModalInput = document.getElementById('loginSenhaModal');

        const formRegistroModal = document.getElementById('formRegistroModal');
        const registroEmailModalInput = document.getElementById('registroEmailModal');
        const registroSenhaModalInput = document.getElementById('registroSenhaModal');
        const registroConfirmaSenhaModalInput = document.getElementById('registroConfirmaSenhaModal');

        // Links de alternância dentro do Modal
        const switchToRegisterInModalLink = document.getElementById('switchToRegisterInModalLink');
        const switchToLoginInModalLink = document.getElementById('switchToLoginInModalLink');

        // Mensagem de feedback dentro do Modal
        const authMessageModal = document.getElementById('authMessageModal');

        function mostrarMensagemAuthModal(mensagem, tipo = 'error') {
            authMessageModal.textContent = mensagem;
            authMessageModal.className = 'auth-message '; // Reseta classes
            if (tipo === 'success') {
                authMessageModal.classList.add('success');
            } else {
                authMessageModal.classList.add('error');
            }
            // Não limpar automaticamente, o usuário fecha o modal ou troca de form
        }

        // --- Funções para controlar o Modal de Autenticação ---
        function openAuthModal(view = 'login') { // 'login' ou 'register'
            if (view === 'login') {
                loginContainerModal.style.display = 'block';
                registroContainerModal.style.display = 'none';
            } else {
                loginContainerModal.style.display = 'none';
                registroContainerModal.style.display = 'block';
            }
            authMessageModal.textContent = ''; // Limpa mensagens antigas
            authMessageModal.className = 'auth-message';

            authModal.style.display = 'flex';
            setTimeout(() => {
                authModal.classList.add('modal-visible');
            }, 10);
            document.body.classList.add('modal-open');
        }

        function closeAuthModal() {
            authModal.classList.remove('modal-visible');
            document.body.classList.remove('modal-open');
            setTimeout(() => {
                if (!authModal.classList.contains('modal-visible')) {
                    authModal.style.display = 'none';
                }
            }, 300);
        }

        if (loginTriggerLink) {
            loginTriggerLink.addEventListener('click', (e) => {
                e.preventDefault();
                openAuthModal('login');
            });
        }
        if (authModalCloseBtn) authModalCloseBtn.onclick = closeAuthModal;

        window.addEventListener('click', function(event) { // Fechar se clicar fora do conteúdo do modal de auth
            if (event.target == authModal) {
                closeAuthModal();
            }
        });


        // --- Links de alternância DENTRO do modal de autenticação ---
        if (switchToRegisterInModalLink) {
            switchToRegisterInModalLink.addEventListener('click', (e) => {
                e.preventDefault();
                openAuthModal('register'); // Reabre/reconfigura o modal para a view de registro
            });
        }
        if (switchToLoginInModalLink) {
            switchToLoginInModalLink.addEventListener('click', (e) => {
                e.preventDefault();
                openAuthModal('login'); // Reabre/reconfigura o modal para a view de login
            });
        }

        // --- LÓGICA DE REGISTRO (adaptada para o modal) ---
        if (formRegistroModal) {
            formRegistroModal.addEventListener('submit', async (e) => {
                e.preventDefault();
                const email = registroEmailModalInput.value;
                const senha = registroSenhaModalInput.value;
                const confirmaSenha = registroConfirmaSenhaModalInput.value;

                if (senha.length < 6) { mostrarMensagemAuthModal('A senha precisa ter no mínimo 6 caracteres.'); return; }
                if (senha !== confirmaSenha) { mostrarMensagemAuthModal('As senhas não coincidem!'); return; }

                try {
                    await window.firebaseAuth.createUserWithEmailAndPassword(email, senha);
                    formRegistroModal.reset();
                    // O onAuthStateChanged cuidará de fechar o modal e atualizar a UI do topo
                    // Poderia adicionar uma mensagem de sucesso aqui antes de fechar, se desejado
                    // mostrarMensagemAuthModal('Conta criada com sucesso! Você está logado.', 'success');
                    // setTimeout(closeAuthModal, 1500); // Fecha o modal após sucesso
                } catch (error) {
                    console.error("Erro no registro:", error);
                    if (error.code === 'auth/email-already-in-use') mostrarMensagemAuthModal('Este email já está em uso.');
                    else if (error.code === 'auth/weak-password') mostrarMensagemAuthModal('Senha muito fraca.');
                    else mostrarMensagemAuthModal('Erro ao registrar: ' + error.message.replace('Firebase: ',''));
                }
            });
        }

        // --- LÓGICA DE LOGIN (adaptada para o modal) ---
        if (formLoginModal) {
            formLoginModal.addEventListener('submit', async (e) => {
                e.preventDefault();
                const email = loginEmailModalInput.value;
                const senha = loginSenhaModalInput.value;
                try {
                    await window.firebaseAuth.signInWithEmailAndPassword(email, senha);
                    formLoginModal.reset();
                    // O onAuthStateChanged cuidará de fechar o modal e atualizar a UI do topo
                } catch (error) {
                    console.error("Erro no login:", error);
                    if (error.code === 'auth/user-not-found' || error.code === 'auth/wrong-password' || error.code === 'auth/invalid-credential' || error.code === 'auth/invalid-email') {
                        mostrarMensagemAuthModal('Email ou senha inválidos.');
                    } else {
                        mostrarMensagemAuthModal('Erro ao fazer login: ' + error.message.replace('Firebase: ',''));
                    }
                }
            });
        }

        // --- LÓGICA DE LOGOUT (adaptada para o novo botão) ---
        if (logoutModalButton) { // Nome do botão de logout foi atualizado
            logoutModalButton.addEventListener('click', async (e) => {
                e.preventDefault();
                try {
                    await window.firebaseAuth.signOut();
                    // O onAuthStateChanged cuidará de atualizar a UI do topo
                } catch (error) {
                    console.error("Erro no logout:", error);
                    // Poderia mostrar uma mensagem global se necessário, mas geralmente o logout não falha assim
                }
            });
        }

        // --- OBSERVADOR DO ESTADO DE AUTENTICAÇÃO (ATUALIZADO para nova UI) ---
        window.firebaseAuth.onAuthStateChanged(user => {
            if (user) { // Usuário está logado
                console.log("Usuário logado:", user.email);
                if (loggedInUserInfo) loggedInUserInfo.style.display = 'flex'; // Mostrar info do usuário
                if (loggedInUserEmailDisplay) loggedInUserEmailDisplay.textContent = user.email;
                if (loginTriggerLink) loginTriggerLink.style.display = 'none'; // Esconder link "Login"
                closeAuthModal(); // Fecha o modal de autenticação se estiver aberto
            } else { // Usuário está deslogado
                console.log("Nenhum usuário logado.");
                if (loggedInUserInfo) loggedInUserInfo.style.display = 'none'; // Esconder info do usuário
                if (loginTriggerLink) loginTriggerLink.style.display = 'inline-block'; // Mostrar link "Login"
            }
        });
    </script>
</body>
</html>
