<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Central de Jogos - Jogue Agora!</title>
    <link rel="stylesheet" href="style.css">
    <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-9402908836616610"
         crossorigin="anonymous"></script>
</head>
<body>
    <div class="container">
        <button id="aboutButton" class="about-button">Sobre</button>
        <header>
            <h1>Bem-vindo à Central de Jogos!</h1>
            <p>Escolha um dos nossos jogos clássicos para se divertir.</p>
        </header>

        <section class="auth-section">
            <div class="auth-forms-container">

                <div class="auth-form" id="registroContainer">
                    <h3>Crie sua Conta</h3>
                    <form id="formRegistro">
                        <div>
                            <label for="registroEmail">Email:</label>
                            <input type="email" id="registroEmail" name="registroEmail" required>
                        </div>
                        <div>
                            <label for="registroSenha">Senha (mínimo 6 caracteres):</label>
                            <input type="password" id="registroSenha" name="registroSenha" required minlength="6">
                        </div>
                        <div>
                            <label for="registroConfirmaSenha">Confirmar Senha:</label>
                            <input type="password" id="registroConfirmaSenha" name="registroConfirmaSenha" required minlength="6">
                        </div>
                        <button type="submit">Registrar</button>
                    </form>
                </div>

                <div class="auth-form" id="loginContainer">
                    <h3>Acesse sua Conta</h3>
                    <form id="formLogin">
                        <div>
                            <label for="loginEmail">Email:</label>
                            <input type="email" id="loginEmail" name="loginEmail" required>
                        </div>
                        <div>
                            <label for="loginSenha">Senha:</label>
                            <input type="password" id="loginSenha" name="loginSenha" required>
                        </div>
                        <button type="submit">Entrar</button>
                    </form>
                </div>

            </div>

            <div id="userInfoContainer" style="display: none;">
                <p>Bem-vindo(a), <span id="userEmailDisplay"></span>!</p>
                <button id="logoutButton">Sair (Logout)</button>
            </div>

            <p id="authMessage" class="auth-message"></p>

        </section>
        <nav class="game-selection">
            <h2>Escolha seu Jogo:</h2>
            <ul>
                <li><a href="snake.html" class="game-link">Jogo da Cobrinha</a></li>
                <li><a href="pong.html" class="game-link">Pong Clássico</a></li>
                <li><a href="quebra_blocos.html" class="game-link">Quebra Blocos</a></li>
            </ul>
        </nav>

        <section class="adsense-area">
            <h2>Anúncios</h2>
            <p>Espaço reservado para anúncios do Google AdSense. <br> Configure sua conta AdSense e cole o código aqui para monetizar seu site.</p>
        </section>

        <footer>
            <p>&copy; 2025 Central de Jogos - Todos os direitos reservados.</p>
        </footer>
    </div> <div id="aboutModal" class="modal">
        <div class="modal-content">
            <span class="close-button">&times;</span>
            <h2>Sobre a Central de Jogos</h2>
            <p>Bem-vindo à Central de Jogos! Este espaço foi cuidadosamente desenvolvido por <strong><a href="https://www.instagram.com/mizykj/" target="_blank" rel="noopener noreferrer" class="inline-link">Mizy Dev</a></strong>.</p>
            <p>A principal motivação por trás da criação deste site é simples: trazer diversão e um toque de nostalgia através de jogos clássicos que marcaram gerações. Queremos oferecer um local onde você possa relaxar, desafiar a si mesmo e, quem sabe, relembrar bons momentos.</p>
            <p>Cada jogo foi implementado com o intuito de ser leve, acessível e fácil de jogar. Esperamos que você desfrute da experiência tanto quanto nós gostamos de criá-la.</p>
            <p>Divirta-se!</p>
            <p><em>- <a href="https://www.instagram.com/mizykj/" target="_blank" rel="noopener noreferrer" class="inline-link">Mizy Dev</a></em></p>
        </div>
    </div>

    <script>
        const modal = document.getElementById('aboutModal');
        const aboutBtn = document.getElementById('aboutButton');
        const closeBtn = modal.querySelector('.close-button');

        aboutBtn.onclick = function() {
            modal.style.display = 'flex';
            setTimeout(function() {
                modal.classList.add('modal-visible');
            }, 10);
            document.body.classList.add('modal-open');
        }

        function closeModalFunction() {
            modal.classList.remove('modal-visible');
            document.body.classList.remove('modal-open');
            setTimeout(function() {
                if (!modal.classList.contains('modal-visible')) {
                    modal.style.display = 'none';
                }
            }, 300);
        }

        closeBtn.onclick = closeModalFunction;

        window.onclick = function(event) {
            if (event.target == modal) {
                closeModalFunction();
            }
        }
    </script>

    <script src="https://www.gstatic.com/firebasejs/9.6.10/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.6.10/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.6.10/firebase-firestore-compat.js"></script>
    <script>
      // Sua configuração do Firebase (use os valores REAIS do seu projeto)
      const firebaseConfig = {
        apiKey: "AIzaSyBYLGHFCAe_Go88NLg9huffQcaH65O8AxU", // SUBSTITUA PELO SEU VALOR REAL
        authDomain: "central-de-jogos-4bdf1.firebaseapp.com", // SUBSTITUA PELO SEU VALOR REAL
        projectId: "central-de-jogos-4bdf1", // SUBSTITUA PELO SEU VALOR REAL
        storageBucket: "central-de-jogos-4bdf1.appspot.com", // VERIFIQUE ESTE VALOR NO SEU CONSOLE FIREBASE
        messagingSenderId: "552827412845", // SUBSTITUA PELO SEU VALOR REAL
        appId: "1:552827412845:web:57af946ce0b1a53a113a64", // SUBSTITUA PELO SEU VALOR REAL
        measurementId: "G-RDL4Y8ELKQ" // SUBSTITUA PELO SEU VALOR REAL (opcional)
      };

      // Initialize Firebase
      firebase.initializeApp(firebaseConfig);

      // Disponibilizar instâncias para uso posterior
      const auth = firebase.auth(); // Usando a sintaxe 'compat'
      const db = firebase.firestore(); // Usando a sintaxe 'compat'

      window.firebaseAuth = auth; // Para usar no script de lógica de auth
      window.firebaseDb = db;   // Para usar no script de lógica de auth e rankings

      console.log("Firebase Compat SDKs carregados e Firebase inicializado!");
    </script>

    <script>
        // Acessando as instâncias globais que criamos acima
        // const auth = window.firebaseAuth; // Já está disponível como 'auth' no escopo anterior, mas podemos pegar da window também
        // const db = window.firebaseDb;

        // Elementos do Formulário de Registro
        const formRegistro = document.getElementById('formRegistro');
        const registroEmailInput = document.getElementById('registroEmail');
        const registroSenhaInput = document.getElementById('registroSenha');
        const registroConfirmaSenhaInput = document.getElementById('registroConfirmaSenha');

        // Elementos do Formulário de Login
        const formLogin = document.getElementById('formLogin');
        const loginEmailInput = document.getElementById('loginEmail');
        const loginSenhaInput = document.getElementById('loginSenha');

        // Elementos da UI para feedback e info do usuário
        const authMessage = document.getElementById('authMessage');
        const userInfoContainer = document.getElementById('userInfoContainer');
        const userEmailDisplay = document.getElementById('userEmailDisplay');
        const logoutButton = document.getElementById('logoutButton');
        const authFormsContainer = document.querySelector('.auth-forms-container');

        function mostrarMensagemAuth(mensagem, tipo = 'error') {
            authMessage.textContent = mensagem;
            authMessage.className = 'auth-message ';
            if (tipo === 'success') {
                authMessage.classList.add('success');
            } else {
                authMessage.classList.add('error');
            }
            setTimeout(() => {
                authMessage.textContent = '';
                authMessage.className = 'auth-message';
            }, 5000);
        }

        if (formRegistro) {
            formRegistro.addEventListener('submit', async (e) => {
                e.preventDefault();
                const email = registroEmailInput.value;
                const senha = registroSenhaInput.value;
                const confirmaSenha = registroConfirmaSenhaInput.value;

                if (senha.length < 6) {
                    mostrarMensagemAuth('A senha precisa ter no mínimo 6 caracteres.');
                    return;
                }
                if (senha !== confirmaSenha) {
                    mostrarMensagemAuth('As senhas não coincidem!');
                    return;
                }

                try {
                    const userCredential = await window.firebaseAuth.createUserWithEmailAndPassword(email, senha);
                    // console.log("Usuário registrado:", userCredential.user);
                    // mostrarMensagemAuth('Usuário registrado com sucesso! Você já está logado.', 'success'); // Mensagem será mostrada pelo onAuthStateChanged
                    formRegistro.reset();
                } catch (error) {
                    console.error("Erro no registro:", error);
                    if (error.code === 'auth/email-already-in-use') {
                        mostrarMensagemAuth('Este email já está em uso.');
                    } else if (error.code === 'auth/weak-password') {
                        mostrarMensagemAuth('Senha muito fraca. Tente uma mais forte.');
                    } else {
                        mostrarMensagemAuth('Erro ao registrar: Verifique os dados ou tente mais tarde.');
                    }
                }
            });
        }

        if (formLogin) {
            formLogin.addEventListener('submit', async (e) => {
                e.preventDefault();
                const email = loginEmailInput.value;
                const senha = loginSenhaInput.value;

                try {
                    const userCredential = await window.firebaseAuth.signInWithEmailAndPassword(email, senha);
                    // console.log("Usuário logado:", userCredential.user);
                    // mostrarMensagemAuth('Login realizado com sucesso!', 'success'); // Mensagem será mostrada pelo onAuthStateChanged
                    formLogin.reset();
                } catch (error) {
                    console.error("Erro no login:", error);
                    if (error.code === 'auth/user-not-found' || error.code === 'auth/wrong-password' || error.code === 'auth/invalid-credential') {
                        mostrarMensagemAuth('Email ou senha inválidos.');
                    } else {
                        mostrarMensagemAuth('Erro ao fazer login: Verifique os dados ou tente mais tarde.');
                    }
                }
            });
        }

        if (logoutButton) {
            logoutButton.addEventListener('click', async () => {
                try {
                    await window.firebaseAuth.signOut();
                    // mostrarMensagemAuth('Você saiu da sua conta.', 'success'); // Mensagem será mostrada pelo onAuthStateChanged
                } catch (error) {
                    console.error("Erro no logout:", error);
                    mostrarMensagemAuth('Erro ao sair: ' + error.message);
                }
            });
        }

        window.firebaseAuth.onAuthStateChanged(user => {
            if (user) {
                console.log("Usuário logado:", user.email);
                if (userInfoContainer) userInfoContainer.style.display = 'block';
                if (userEmailDisplay) userEmailDisplay.textContent = user.email;
                if (authFormsContainer) authFormsContainer.style.display = 'none';
                if (logoutButton) logoutButton.style.display = 'inline-block';
                // Limpar qualquer mensagem de erro pendente de login/registro
                authMessage.textContent = '';
                authMessage.className = 'auth-message';
                // Opcional: mostrar uma mensagem de boas-vindas aqui se for o primeiro login após registro/login
                // if (!logoutButton.dataset.welcomed) { // Evitar mostrar toda vez que o estado muda
                //    mostrarMensagemAuth(`Bem-vindo(a) de volta, ${user.email}!`, 'success');
                //    logoutButton.dataset.welcomed = true;
                // }

            } else {
                console.log("Nenhum usuário logado.");
                if (userInfoContainer) userInfoContainer.style.display = 'none';
                if (authFormsContainer) authFormsContainer.style.display = 'flex';
                if (logoutButton) logoutButton.style.display = 'none';
                // delete logoutButton.dataset.welcomed; // Resetar para próxima sessão de login
            }
        });
    </script>
</body>
</html>
